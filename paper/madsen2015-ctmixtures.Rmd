
```{r libraries, echo=FALSE, cache=FALSE} 
library(ggplot2) 
library(randtoolbox) 
library(xtable) 
library(dplyr)
library(magrittr)
options(tikzDefaultEngine = "xetex")
```

# Introduction

A major use of cultural transmission models in archaeology over the past decade has been inference regarding the type of social learning process (or "mode of transmission") operative within past populations.  Identifying the mode of past cultural transmission is important, for example, to testing evolutionary hypotheses for how cumulative cultural transmission and complex culture evolved in the first place [e.g., @BR1985; @CF1981; @Henrich:1998ek; @Wakano:2007gq].  In more recent archaeological settings, the identification of frequency-biased social learning is often taken to indicate something about the sociopolitical structure of past societies [e.g., @kohler2004].  In fact, a great deal of the theoretical work on cultural transmission within archaeology during the first decade of the twenty-first century focused upon understanding the statistical "signatures" of different modes of transmission and how one might infer such modes from archaeological data [e.g, @Bentley2003; @bentley2007regular; @bentley2004random; @kohler2004; @Mesoudi2009; @shennan2001ceramic; @steele2010ceramic].  This body of work characterized modes of transmission within "pure strategy" populations, usually with point or synchronic measurements, and frequently employed population census data rather than sample statistics. 

More recently, a number of researchers have focused upon our ability to conduct inference concerning transmission mode from data which are time averaged, derive from a population of changing size, or using statistics which are interval or diachronic in nature [@kandler2013non; @Madsen2012TA; @Porcic2014Exploring-the-E; @Premo:2014jv; @Rorabaugh:2014fl].  This research is important since the vast majority of applications will involve settings where archaeological evidence has significant temporal aggregation, non-stationarity of model parameters, and of course, samples rather than a census of the archaeological record.

An overarching lesson of this work is that modes of transmission which can be cleanly distinguished in homogeneous models may display considerable equifinality in more complex and realistic settings.  Mesoudi and Lycett [-@Mesoudi2009,p42] note that "[p]erhaps some mix of conformity, anti-conformity and innovation combine to produce aggregate, population-level data that are indistinguishable from random copying."  The authors are correct, but we need to go further than considering equifinality a mere possibility.  We should expect equifinalities to occur frequently in real-world studies of cultural transmission, and develop methods to allow its identification and possible reduction.  Particularly when we study large or heterogeneous populations, and particularly when our data comprise small samples of the record representing appreciable durations, we should expect equifinality to be the norm, not the exception.  In such cases, we need to understand whether our hypotheses are statistically distinguishable before we use them to confront empirical data, so that we can adjust our sampling and analytical strategy to either (a) eliminate the equifinalities if possible, or (b) change our research design to fit larger classes of models to our data.  

Equifinalities may arise between transmission models from two sources.  Overlap in the statistical outcomes of transmission models may be inherent to the theoretical models themselves, especially in a stochastic evolutionary process where variability is the driving factor of change.  Heterogeneity in evolutionary processes is especially important, whether among individuals employing different transmission strategies, or because of spatial structure which creates assortative structures within transmission networks.  Equifinality arising from such sources are often __irreducible__ since we typically cannot observe individual transmission events and disentangle different transmission chains.  In cases where data are coarse grained with respect to transmission events -- a prescription which covers most but not all archaeological settings -- models which are irreducibly equifinal form __equivalence classes__ of models we cannot distinguish given the variables measured and the spatiotemporal scale of that measurement.  In such settings, questions regarding transmission modes are questions we cannot answer convincingly, and thus we may need to alter our research designs.  We might, for example, only be able to ask whether the entire class of models is a good fit to our data, without being able to name the exact mode of transmission in more detail.  At the extreme, we might have to employ a larger scale in our analysis and focus upon regional scale transmission patterns, and eschew more detailed questions at local scales.  

At the same time, equifinality may occur because of our measurement and analysis procedures.  There is growing evidence, for example, that time averaging affects our ability to distinguish biased from neutral transmission with some statistics, but not others [@Premo:2014jv], and that samples with smaller temporal duration suffer less from time averaging effects than deposits of long duration [@Madsen2012TA; @Porcic2014Exploring-the-E; @Premo:2014jv].  When equifinality arises because of the interaction between analytic methods and theoretical models, it may be __reducible__ given different choices of statistics, finer-grained data collection, or other approaches.  Kandler and Shennan's [-@kandler2013non] work on diachronic measures of neutrality, for example, suggests that careful choice of statistics is critical for fitting transmission models to archaeological data.  

In this paper, I develop a systematic approach to identifying equifinality among cultural transmission models, using a machine learning classifier method to study the separability of simulated data sets from each model in a hypothesis set.  To illustrate the approach, I examine our ability to correctly identify neutral or random copying, compared to a number of mixtures of biased transmission models.  Simulated observations from each transmission process are recorded at a variety of sample sizes and across several durations of temporal aggregation to model time averaged deposits [@Madsen2012TA; @Premo:2014jv].  Using a single set of simulated data points, the method described here addresses reducible equifinalities by comparison of classifier results across these sampling strategies, identifying irreducible equifinality when it exists.  I end the paper with a reanalysis of data from several archaeological studies of transmission modes, using the trained classifiers and simulated samples to assess the original interpretation of each data set.  

# Theory

The general name for  is __equifinality__.  The term was introduced by Ludwig von Bertalanffy [-@von1949problems], to denote situations where different initial conditions in an open system lead to the same final outcomes.  Subsequently, equifinality has come to denote situations where different dynamical models, or parameterizations of models, yield statistically indistinguishable outcomes.  The term is used across several fields, including developmental psychology, paleoclimatology, geography, hydrology, and anthropology [@Aronica:1998dm; @Beven:2006js; @Bonham:2009bi; @Cicchetti:1996gp; @Culling:1987kx; @lyman1994vertebrate; @Marean:1992hg; @Phillips:1997kx; @Rogers:2000bq; @Savenije:2001fe].  

Evolutionary models fundamentally describe the diffusion and persistence of variants in an interacting population over space and time.  As such, there is inherently a great deal of overlap in the dynamic behavior of models.  For example, models of neutral drift which vary in mating or spatial structure converge, in a large population limit, to the same diffusion process [@Der:2011ip].  The first and second moments of this diffusion process cannot be used to distinguish the underlying processes, which are thus equifinal given these observable variables.  But as Der and colleagues [-@Der:2011ip] show, higher moments are capable of discriminating among different models, all of which describe different classes of neutral models.  Equifinality is thus not merely a property of models, but of models and the suite of observable variables or summary statistics used to describe their behavior.  

We should also expect equifinality among cultural transmission models to be increased by population heterogeneity and the effects of coarse-grained observation.  In realistic populations, the modes of social learning employed by individuals varies by situation, the other individuals present, and many other factors.  We should expect that heterogeneous populations will not display the clear statistical patterns for single modes of cultural transmission, such as the power-law relationship posited by Bentley [-@Bentley2003; @bentley2004random] for unbiased transmission.  Furthermore, when observation of the results of cultural transmission is "coarse grained" with respect to the time scales over which social learning occurs, additional potential for equifinality exists.  Thus, equifinality should be a greater problem in assemblages which are strongly time averaged, compared to those with small durations of accumulation.  




* Cultural transmission models are copying processses at the individual level, and diffusions when coarse grained or taken to the large population limit.  
* Observable quantities include the quasi-stationary frequency distribution of types, average time to loss, distribution of type numbers, distribution of the age of types in a sample or the population.  
* Even at the most detailed level, we can expect that many different histories, and many different copying processes, might yield the same values for any statistics on the available observable quantities -- this is equifinality.
* Equifinality is relative not just to a set of models, however, but to the variables and measures one uses to attempt to distinguish their behavior.  
* The difference between scale of observation and the scale at which social learning occurs (coarse graining) may contribute strongly to equifinality.  Whenever individual social learning events are aggregated, either by classification or spatiotemporal aggregation (for example, time averaging in bulk samples of archaeological deposits), equifinality among models or model classes may occur.  
* Equifinality is, at a methodological level, a classification accuracy problem in the sense of statistics or machine learning.  Here, I take an ML approach to study its onset and occurrence in a set of often used CT models.  


# Materials and Methods

## Simulating Heterogeneous Cultural Transmission ##

* Agent-based model, with individual copying rules
* Moran dynamic, continuous time Markov process with overlapping generations
* Simulate at a single population size, with uniform priors for other parameters
* Capture synchronic population statistics at the end, synchronic sample statistics at various sample sizes, and time averaged sample statistics, at a variety of time averaging intervals and sample sizes





## Analysis of Equifinality ##


* Equifinality analysis using classifier methods
* Simulated 25,000 samples from each of 4 models.  3 biased and 1 neutral, with uniform priors on parameters
* Each sample is labeled, allowing us to determine the error rate for classification
* Random forest method employed, with 80% of the data used as training set, and 20% as a hold out test set.  

### Random Forest Classifiers ###

Paragraph on what RF are.  Citations on the few archaeological uses.  

* one of the best "off the shelf" classifiers, comparable in performance to modern variants on CART trees like C5.0, gradient boosted models.  
* highly robust to the presence of non-informative predictors, which allows us to use it in an exploratory manner, while also getting strong answers to classification questions like equifinality.  
* The approach used here employs a large training set, and repeated (10x) 10-fold cross-validation to train and tune the model in a single (albeit computationally significant pass).  The results of training provide measures of the variance around model parameters (such as $m_{try}$).  The resulting fit model is then available for prediction of the test set, which is the set of results used to judge equifinality.  


## Reanalysis of Archaeological Examples ##

* Equifinality data set also serves as simulated data points for approximate bayesian computation
* Use Csillery's ABC package in R to examine model fit for empirical data sets.  

# Results




Lorem ipsum dolor sit amet, consectetur adipiscing elit. Vestibulum dignissim dignissim nunc, et finibus urna aliquam eget. Donec enim dolor, aliquam sed iaculis vitae, vestibulum sed justo. Curabitur fringilla, mauris quis ultrices mattis, neque libero volutpat nisi, vel mollis mi magna a felis. Phasellus a orci ut elit sodales tristique ac placerat nisi. Maecenas orci purus, ullamcorper non neque vel, imperdiet sollicitudin ante. Duis dapibus ante sed gravida imperdiet. Aenean dapibus augue nec vehicula rhoncus. Mauris ac fermentum ante, eget volutpat lectus. Nunc a est auctor, suscipit augue vel, vulputate lectus. Sed eu elit ullamcorper, interdum neque ut, varius nisi. Phasellus leo justo, mattis rutrum leo vitae, consequat auctor diam. Vivamus cursus, ligula et euismod iaculis, odio nulla ullamcorper ex, vitae cursus mi lacus at sem. Aenean dictum odio dolor, sit amet gravida sem scelerisque vitae. Pellentesque habitant morbi tristique senectus et netus et malesuada fames ac turpis egestas. Morbi.


# Discussion

Lorem ipsum dolor sit amet, consectetur adipiscing elit. Vestibulum dignissim dignissim nunc, et finibus urna aliquam eget. Donec enim dolor, aliquam sed iaculis vitae, vestibulum sed justo. Curabitur fringilla, mauris quis ultrices mattis, neque libero volutpat nisi, vel mollis mi magna a felis. Phasellus a orci ut elit sodales tristique ac placerat nisi. Maecenas orci purus, ullamcorper non neque vel, imperdiet sollicitudin ante. Duis dapibus ante sed gravida imperdiet. Aenean dapibus augue nec vehicula rhoncus. Mauris ac fermentum ante, eget volutpat lectus. Nunc a est auctor, suscipit augue vel, vulputate lectus. Sed eu elit ullamcorper, interdum neque ut, varius nisi. Phasellus leo justo, mattis rutrum leo vitae, consequat auctor diam. Vivamus cursus, ligula et euismod iaculis, odio nulla ullamcorper ex, vitae cursus mi lacus at sem. Aenean dictum odio dolor, sit amet gravida sem scelerisque vitae. Pellentesque habitant morbi tristique senectus et netus et malesuada fames ac turpis egestas. Morbi.


# Acknowledgements

Lorem ipsum dolor sit amet, consectetur adipiscing elit. Vestibulum dignissim dignissim nunc, et finibus urna aliquam eget. Donec enim dolor, aliquam sed iaculis vitae, vestibulum sed justo. Curabitur fringilla, mauris quis ultrices mattis, neque libero volutpat nisi, vel mollis mi magna a felis. Phasellus a orci ut elit sodales tristique ac placerat nisi. Maecenas orci purus, ullamcorper non neque vel, imperdiet sollicitudin ante. 

