
```{r libraries, echo=FALSE, cache=FALSE} 
library(ggplot2) 
library(randtoolbox) 
library(xtable) 
library(dplyr)
library(magrittr)
options(tikzDefaultEngine = "xetex")
```

# Introduction

A major use of cultural transmission models in archaeology over the past decade has been inference regarding the type of social learning process (or "mode of transmission") operative within past populations.  Identifying the mode of past cultural transmission is important, for example, to testing evolutionary hypotheses for how cumulative cultural transmission and complex culture evolved in the first place [e.g., @BR1985; @CF1981; @Henrich:1998ek; @Wakano:2007gq].  In more recent archaeological settings, the identification of frequency-biased social learning is often linked to the sociopolitical structure of past societies [e.g., @kohler2004].  In fact, a great deal of the theoretical work on cultural transmission within archaeology during the first decade of the twenty-first century focused upon understanding the statistical "signatures" of different modes of transmission and how one might infer such modes from archaeological data [e.g, @Bentley2003; @bentley2007regular; @bentley2004random; @kohler2004; @Mesoudi2009; @shennan2001ceramic; @steele2010ceramic].  This body of work characterized modes of transmission within "pure strategy" populations, usually with point or synchronic measurements, and frequently employed analysis of census data from simulated populations rather than samples, as would be typical in most empirical situations. 

More recently, a number of researchers have focused upon our ability to conduct inference concerning transmission mode from data which derive from a population of changing size, are time averaged, or using statistics which are interval or diachronic in nature [@kandler2013non; @Madsen2012TA; @Porcic2014Exploring-the-E; @Premo:2014jv; @Rorabaugh:2014fl].  This expansion of approach is important since nearly all applications involve settings where archaeological evidence is derived from samples of the record, and most also involve some combination of temporal aggregation and non-stationarity of model parameters such as changing population size and innovation rates.

One of the principal lessons of more recent work is that social learning modes which can be easily distinguished in simple models, become less distinguishable in models which incorporate more complex structure and realism.  At the extreme, models can be "equifinal," leading to the same patterns within data despite describing very different processes [@von1949problems].  In particular, more complex cultural transmission models which introduce one or more sources of heterogeneity within a population, will often display empirical patterns which overlap, despite arising from distinct underlying processes [@Mesoudi2009,p42].  Equifinality between theoretical models is a serious concern whenever we study complex systems, and has been discussed in geomorphology, hydrology, climatology, and within archaeology itself [@Aronica:1998dm; @Beven:2006js; @Bonham:2009bi; @Cicchetti:1996gp; @Culling:1987kx; @Marean:1992hg; @Rogers:2000bq; @Savenije:2001fe].  

When considerable equifinality exists between theoretical models, we cannot treat them as distinguishable in our data, despite the fact that we may be able to fit one of the models to our data with acceptable significance values or errors.  In this paper, I argue that when we cannot distinguish models **up front** using Monte Carlo or individual-based simulation models, we cannot hope to treat them as competing hypotheses in an empirical study.  Where we can distinguish among a model set, however, we can proceeed with reasonable confidence to employ estimation and model selection techniques to infer which model fits a set of empirical data the best.  Where significantly equifinalities exist, we need to redesign some aspect of the study.  Our ability to "design around" equifinality, however, depends upon the source of that equifinality. 

Equifinality among transmission models can arise from two sources.  Overlap in the statistical outcomes of transmission models may be inherent to the theoretical models themselves, especially in evolutionary processes where variability is the driving factor of change.  Simply put, stochastic models of diffusion processes often lead to similar distributions of outcomes, even if the details of the processes vary slightly.  We may be able to differentiate closely related models if we can follow specific trajectories in a "longitudinal"  study [REF MESOUDI CHAINS], but if we cannot observe a related sequence of events (e.g., a transmission chain), our ability to identify the specifics of a diffusion model may be lost.  I refer to this type of equifinality as __irreducible__.  Irreducibly equifinal transmission models form an __equivalence class__ of models that we cannot distinguish given our data --- we can simply identify a set of data as having been generated by the entire class of models.  In such settings, research questions regarding transmission modes may be questions we cannot answer convincingly, and thus we may need to alter our research designs.  At the extreme, we might have to employ a larger scale in our analysis and focus upon regional scale transmission patterns, and eschew more detailed questions at local scales.  

At the same time, equifinality may occur because of our measurement and analysis procedures.  There is growing evidence, for example, that time averaging affects our ability to distinguish biased from neutral transmission with some statistics, but not others [@Premo:2014jv], and that samples with smaller temporal duration suffer less from time averaging effects than deposits of long duration [@Madsen2012TA; @Porcic2014Exploring-the-E; @Premo:2014jv].  When equifinality arises because of the interaction between analytic methods and theoretical models, it may be __reducible__ given different choices of statistics, finer-grained data collection, or other approaches.  Kandler and Shennan's [-@kandler2013non] work on diachronic measures of neutrality, for example, suggests that careful choice of statistics is critical for fitting transmission models to archaeological data, and Premo's [-@Premo:2014jv] work suggests that power-law distributions.....[HERE]

In this paper, I demonstrate a systematic approach to identifying equifinality among cultural transmission models, using simulation methods and an accurate machine learning classifier algorithm.  The approach is demonstrated by examining equifinality among simulated populations displaying unbiased and mixtures of biased social learning rules.   Simulated observations from each transmission process are recorded at a variety of sample sizes and across several durations of temporal aggregation to model time averaged deposits [@Madsen2012TA; @Premo:2014jv].  

The results indicate that while neutral and biased transmission models can be distinguished very accurately given measurements from entire populations taken without temporal aggregation, the introduction of sampling and the interaction between sampling and temporal aggregation markedly degrades our ability to distinguish between unbiased and biased transmission.  Furthermore, the degredation is not symmetric.  Our ability to properly classify samples which do arise from a biased transmission process remains strong, but samples arising from an unbiased transmission process are subject to disproportionate identification error.  In short, with sampled, time averaged data, we are extremely likely to conclude that samples represent biased transmission, even when this is not the case.  Reducing this equifinality may be possible given the ability to gather large samples, include variables not measured here, or reduce the duration over which samples are time averaged.  Where such reductions in equifinality are not possible, investigators would be well advised to examine different research questions suitable for coarse-grained data.  

# Materials and Methods

In formulating a set of cultural transmission models to apply to a set of archaeological data, we need to understand the degree to which the models are statistically distinguishable.  Two models are perfectly distinguishable when each process generates dynamical outcomes, measured by one or many variables, do not overlap in the space formed by the measured variables.\footnote{This abstract space is sometimes called the "state space" when discussing the model itself; in the context of statistical and machine learning algorithms for measuring overlap, we'll call this the "feature space."}  It is rare that models will be perfectly distiguishable, however.  Evolutionary models, in particular, are usually constructed as stochastic diffusion processes within a population (sometimes purely temporal, sometimes spatiotemporal), and the behavior of such models is highly variable and tends on the same functional forms albeit with different parameters or different higher-order terms.  In such cases, we would expect significant overlap in the behavior of models in the feature space, which reduces our abiilty to distinguish the model responsible for a given data point, should the data point occur in an area of overlap.


\begin{figure}[ht]
\centering
\includegraphics[scale=0.3]{figure/distributional-overlap.pdf}
\caption{Simple example of model outcomes with separable distributions (A), two models with a limited overlap region (B), and two models whose outcomes are highly overlapping, and would cause equifinality in an analysis (C).}
\label{img:separability-example}
\end{figure}

Thus, the assessment of equifinality involves the assessment of the overlap between two or more models $\mathcal{M}_1 \ldots \mathcal{M}_n$, in the feature space of their outcomes.  In supervised learning, the Bayes risk (or error rate) of a decision rule gives the minimum expected probability of correctly predicting the $Y$ value for a data point, given a set of predictor variables $x_1, \ldots, x_n$.   Models whose outcomes do not overlap at all in the feature space give rise to regression equations or classifier rules which can perfectly predict the model responsible for a given data point, as in the left panel of Figure \ref{img:separability-example}.  In such cases, the smallest average error is zero.  Most of the time, however, there is overlap between model outcomes.  The volume of that overlap in the feature space is a measure of our uncertainty in assigning data points to the correct model.  The Bayes risk for such situations is positive and greater than zero, as in the right panel of Figure \ref{img:separability-example}.  If the overlap is sufficient, the Bayes error rate could approach 0.5, which represents a classifier rule which is no better than flipping a coin.  We can therefore treat the assessment of equifinality as a problem in determining the minimum possible error rate achievable by a classifier rule which takes in a set of predictor variables, and produces a prediction for the model responsible.   

However, in almost all cases we can't calculate the Bayes error rate of a classifier rule, because we lack expressions for the probability distribution of model outcomes over the space of measured variables, and in real data sets we usually also lack good prior information about how frequently we expect each model to be represented in the real world.  In fact, the Bayes error rate is directly calculable only for a very few simple models, such as Gaussian class distributions with identical covariance matrices.  Instead, we need to approximate the Bayes rate, by constructing classifier rules which minimize the empirical error over a variety of training data sets, and have minimal error on hold-out test data.  






## Simulating Heterogeneous Cultural Transmission ##

* Agent-based model, with individual copying rules
* Moran dynamic, continuous time Markov process with overlapping generations
* Simulate at a single population size, with uniform priors for other parameters
* Capture synchronic population statistics at the end, synchronic sample statistics at various sample sizes, and time averaged sample statistics, at a variety of time averaging intervals and sample sizes





## Analysis of Equifinality ##


* Equifinality analysis using classifier methods
* Simulated 25,000 samples from each of 4 models.  3 biased and 1 neutral, with uniform priors on parameters
* Each sample is labeled, allowing us to determine the error rate for classification
* Random forest method employed, with 80% of the data used as training set, and 20% as a hold out test set.  

### Random Forest Classifiers ###

Paragraph on what RF are.  Citations on the few archaeological uses.  

* one of the best "off the shelf" classifiers, comparable in performance to modern variants on CART trees like C5.0, gradient boosted models.  
* highly robust to the presence of non-informative predictors, which allows us to use it in an exploratory manner, while also getting strong answers to classification questions like equifinality.  
* The approach used here employs a large training set, and repeated (10x) 10-fold cross-validation to train and tune the model in a single (albeit computationally significant pass).  The results of training provide measures of the variance around model parameters (such as $m_{try}$).  The resulting fit model is then available for prediction of the test set, which is the set of results used to judge equifinality.  



\begin{algorithm}[H]
        \caption{}
        \label{alg:tree-prereq-axelrod}
        \begin{boxedminipage}{\textwidth}
        \begin{algorithmic}[1]
                %\REQUIRE lossrate is the population rate at which traits are randomly lost to drift
                \REQUIRE innovrate is the population rate at which individuals randomly learn a trait
                \REQUIRE learningrate is the probability of learning a missing prerequisite during a learning interaction

                \STATE { $focal \leftarrow$ GetRandomAgent()}
                \STATE { $neighbor \leftarrow$ GetRandomNeighbor(focal)}

                \IF { $focal = neighbor \lor focal \cap neighbor = \varnothing\;\lor
                neighbor \subsetneq focal $}
                \label{alg:ext-first-if}
                        \STATE { exit }
                        \COMMENT{ No interaction is possible, move on to next agent }
                \ENDIF

        \end{algorithmic}
        \end{boxedminipage}
\end{algorithm}






## Reanalysis of Archaeological Examples ##

* Equifinality data set also serves as simulated data points for approximate bayesian computation
* Use Csillery's ABC package in R to examine model fit for empirical data sets.  

# Results




Lorem ipsum dolor sit amet, consectetur adipiscing elit. Vestibulum dignissim dignissim nunc, et finibus urna aliquam eget. Donec enim dolor, aliquam sed iaculis vitae, vestibulum sed justo. Curabitur fringilla, mauris quis ultrices mattis, neque libero volutpat nisi, vel mollis mi magna a felis. Phasellus a orci ut elit sodales tristique ac placerat nisi. Maecenas orci purus, ullamcorper non neque vel, imperdiet sollicitudin ante. Duis dapibus ante sed gravida imperdiet. Aenean dapibus augue nec vehicula rhoncus. Mauris ac fermentum ante, eget volutpat lectus. Nunc a est auctor, suscipit augue vel, vulputate lectus. Sed eu elit ullamcorper, interdum neque ut, varius nisi. Phasellus leo justo, mattis rutrum leo vitae, consequat auctor diam. Vivamus cursus, ligula et euismod iaculis, odio nulla ullamcorper ex, vitae cursus mi lacus at sem. Aenean dictum odio dolor, sit amet gravida sem scelerisque vitae. Pellentesque habitant morbi tristique senectus et netus et malesuada fames ac turpis egestas. Morbi.


# Discussion

Lorem ipsum dolor sit amet, consectetur adipiscing elit. Vestibulum dignissim dignissim nunc, et finibus urna aliquam eget. Donec enim dolor, aliquam sed iaculis vitae, vestibulum sed justo. Curabitur fringilla, mauris quis ultrices mattis, neque libero volutpat nisi, vel mollis mi magna a felis. Phasellus a orci ut elit sodales tristique ac placerat nisi. Maecenas orci purus, ullamcorper non neque vel, imperdiet sollicitudin ante. Duis dapibus ante sed gravida imperdiet. Aenean dapibus augue nec vehicula rhoncus. Mauris ac fermentum ante, eget volutpat lectus. Nunc a est auctor, suscipit augue vel, vulputate lectus. Sed eu elit ullamcorper, interdum neque ut, varius nisi. Phasellus leo justo, mattis rutrum leo vitae, consequat auctor diam. Vivamus cursus, ligula et euismod iaculis, odio nulla ullamcorper ex, vitae cursus mi lacus at sem. Aenean dictum odio dolor, sit amet gravida sem scelerisque vitae. Pellentesque habitant morbi tristique senectus et netus et malesuada fames ac turpis egestas. Morbi.


# Acknowledgements

Lorem ipsum dolor sit amet, consectetur adipiscing elit. Vestibulum dignissim dignissim nunc, et finibus urna aliquam eget. Donec enim dolor, aliquam sed iaculis vitae, vestibulum sed justo. Curabitur fringilla, mauris quis ultrices mattis, neque libero volutpat nisi, vel mollis mi magna a felis. Phasellus a orci ut elit sodales tristique ac placerat nisi. Maecenas orci purus, ullamcorper non neque vel, imperdiet sollicitudin ante. 

