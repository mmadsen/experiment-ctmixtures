
```{r libraries, echo=FALSE, cache=FALSE} 
library(ggplot2) 
library(randtoolbox) 
library(xtable) 
library(dplyr)
library(magrittr)
options(tikzDefaultEngine = "xetex")
```

# Introduction

A major use of cultural transmission models in archaeology over the past decade has been inference regarding the type of social learning process (or "mode of transmission") operative within past populations.  Identifying the mode of past cultural transmission is important, for example, to testing evolutionary hypotheses for how cumulative cultural transmission and complex culture evolved in the first place [e.g., @BR1985; @CF1981; @Henrich:1998ek; @Wakano:2007gq].  In more recent archaeological settings, the identification of frequency-biased social learning is often linked to the sociopolitical structure of past societies [e.g., @kohler2004].  In fact, a great deal of the theoretical work on cultural transmission within archaeology during the first decade of the twenty-first century focused upon understanding the statistical "signatures" of different modes of transmission and how one might infer such modes from archaeological data [e.g, @Bentley2003; @bentley2007regular; @bentley2004random; @kohler2004; @Mesoudi2009; @shennan2001ceramic; @steele2010ceramic].  This body of work characterized modes of transmission within "pure strategy" populations, usually with point or synchronic measurements, and frequently employed population census data rather than sample statistics. 

More recently, a number of researchers have focused upon our ability to conduct inference concerning transmission mode from data which derive from a population of changing size, are time averaged, or using statistics which are interval or diachronic in nature [@kandler2013non; @Madsen2012TA; @Porcic2014Exploring-the-E; @Premo:2014jv; @Rorabaugh:2014fl].  This expansion of approach is important since nearly all applications involve settings where archaeological evidence is derived from samples of the record, and most also involve some combination of temporal aggregation and non-stationarity of model parameters such as changing population size and innovation rates.

One of the principal lessons of this body of work is that social learning modes which can be easily distinguished in simple models, become less distinguishable in models which incorporate more complex structure and realism.  At the extreme, models can be indistinguishable, leading to "equifinality" [@von1949problems].  In particular, more complex cultural transmission models which introduce one or more sources of heterogeneity within a population, will often display empirical patterns which overlap, despite arising from distinct underlying processes [@Mesoudi2009,p42].  Equifinality between theoretical models is a serious concern whenever we study complex systems, and has been discussed in geomorphology, hydrology, climatology, and within archaeology itself [@Aronica:1998dm; @Beven:2006js; @Bonham:2009bi; @Cicchetti:1996gp; @Culling:1987kx; @Marean:1992hg; @Rogers:2000bq; @Savenije:2001fe].  

Since inference to the most likely social learning model has been an important aspect of applying cultural transmission models in archaeology and related disciplines, equifinality where it exists would render such inferences unreliable.  A critical part of forming the set of candidate models for such a study is understanding the degree to which models are statistically distinguishable across the parameter ranges of interest.  When we can distinguish among a model set given measured predictor variables with high accuracy, we can proceed with reasonable confidence to infer the model which fits empirical data the best.  When we cannot distinguish models in a set based purely upon the behavior of the model given a set of measured predictors, we need to redesign some aspect of the study before proceeding, hopefully eliminating or reducing the equifinality.  
 

Equifinality among transmission models can arise from two sources.  Overlap in the statistical outcomes of transmission models may be inherent to the theoretical models themselves, especially in evolutionary processes where variability is the driving factor of change.  Simply put, stochastic models of diffusion processes often lead to similar distributions of outcomes, even if the details of the processes vary slightly.  We may be able to differentiate closely related models if we can follow specific trajectories in a "longitudinal"  study [REF MESOUDI CHAINS], but if we cannot observe a related sequence of events (e.g., a transmission chain), our ability to identify the specifics of a diffusion model may be lost.  I refer to this type of equifinality as __irreducible__.  Irreducibly equifinal transmission models form an __equivalence class__ of models that we cannot distinguish given our data --- we can simply identify a set of data as having been generated by the entire class of models.  In such settings, research questions regarding transmission modes may be questions we cannot answer convincingly, and thus we may need to alter our research designs.  At the extreme, we might have to employ a larger scale in our analysis and focus upon regional scale transmission patterns, and eschew more detailed questions at local scales.  

At the same time, equifinality may occur because of our measurement and analysis procedures.  There is growing evidence, for example, that time averaging affects our ability to distinguish biased from neutral transmission with some statistics, but not others [@Premo:2014jv], and that samples with smaller temporal duration suffer less from time averaging effects than deposits of long duration [@Madsen2012TA; @Porcic2014Exploring-the-E; @Premo:2014jv].  When equifinality arises because of the interaction between analytic methods and theoretical models, it may be __reducible__ given different choices of statistics, finer-grained data collection, or other approaches.  Kandler and Shennan's [-@kandler2013non] work on diachronic measures of neutrality, for example, suggests that careful choice of statistics is critical for fitting transmission models to archaeological data, and Premo's [-@Premo:2014jv] work suggests that power-law distributions.....[HERE]

In this paper, I demonstrate a systematic approach to identifying equifinality among cultural transmission models, using simulation methods and an accurate machine learning classifier algorithm.  The approach is demonstrated by examining equifinality among simulated populations displaying unbiased and mixtures of biased social learning rules.   Simulated observations from each transmission process are recorded at a variety of sample sizes and across several durations of temporal aggregation to model time averaged deposits [@Madsen2012TA; @Premo:2014jv].  The results indicate that while neutral and biased transmission models can be distinguished quite accurately given measurements from entire populations taken without temporal aggregation, the introduction of sampling and the interaction between sampling and temporal aggregation markedly degrades our ability to distinguish between unbiased and biased transmission.  Furthermore, the degredation is not symmetric, and it is extremely likely in realistic archaeological samples that inferences will identify models as coming from biased cultural transmission, regardless of the actual model which generated the sample.  I conclude with some observations about the utility of attempting to assess social learning mode from coarse-grained, time-averaged archaeological data.  


# Materials and Methods

In formulating a set of cultural transmission models to apply in explaining patterns visible in archaeological assemblages, we need to understand the degree to which the models are distinguishable given a set of variables we can measure on those assemblages.  Equifinality is thus not an absolute quantity, but a judgment of statistical distinguishability between two or more models $\mathcal{M}_1 \ldots \mathcal{M}_n$, given an inference method, and a set of measurable predictor variables $x_1, \ldots, x_n$.  Given a set of models and a set of empirically measurable variable, we can assess potential equifinality by employing Algorithm \ref{alg:classifier-equifinality}.  





## Simulating Heterogeneous Cultural Transmission ##

* Agent-based model, with individual copying rules
* Moran dynamic, continuous time Markov process with overlapping generations
* Simulate at a single population size, with uniform priors for other parameters
* Capture synchronic population statistics at the end, synchronic sample statistics at various sample sizes, and time averaged sample statistics, at a variety of time averaging intervals and sample sizes





## Analysis of Equifinality ##


* Equifinality analysis using classifier methods
* Simulated 25,000 samples from each of 4 models.  3 biased and 1 neutral, with uniform priors on parameters
* Each sample is labeled, allowing us to determine the error rate for classification
* Random forest method employed, with 80% of the data used as training set, and 20% as a hold out test set.  

### Random Forest Classifiers ###

Paragraph on what RF are.  Citations on the few archaeological uses.  

* one of the best "off the shelf" classifiers, comparable in performance to modern variants on CART trees like C5.0, gradient boosted models.  
* highly robust to the presence of non-informative predictors, which allows us to use it in an exploratory manner, while also getting strong answers to classification questions like equifinality.  
* The approach used here employs a large training set, and repeated (10x) 10-fold cross-validation to train and tune the model in a single (albeit computationally significant pass).  The results of training provide measures of the variance around model parameters (such as $m_{try}$).  The resulting fit model is then available for prediction of the test set, which is the set of results used to judge equifinality.  



\begin{algorithm}[H]
        \caption{}
        \label{alg:tree-prereq-axelrod}
        \begin{boxedminipage}{\textwidth}
        \begin{algorithmic}[1]
                %\REQUIRE lossrate is the population rate at which traits are randomly lost to drift
                \REQUIRE innovrate is the population rate at which individuals randomly learn a trait
                \REQUIRE learningrate is the probability of learning a missing prerequisite during a learning interaction

                \STATE { $focal \leftarrow$ GetRandomAgent()}
                \STATE { $neighbor \leftarrow$ GetRandomNeighbor(focal)}

                \IF { $focal = neighbor \lor focal \cap neighbor = \varnothing\;\lor
                neighbor \subsetneq focal $}
                \label{alg:ext-first-if}
                        \STATE { exit }
                        \COMMENT{ No interaction is possible, move on to next agent }
                \ENDIF

        \end{algorithmic}
        \end{boxedminipage}
\end{algorithm}






## Reanalysis of Archaeological Examples ##

* Equifinality data set also serves as simulated data points for approximate bayesian computation
* Use Csillery's ABC package in R to examine model fit for empirical data sets.  

# Results




Lorem ipsum dolor sit amet, consectetur adipiscing elit. Vestibulum dignissim dignissim nunc, et finibus urna aliquam eget. Donec enim dolor, aliquam sed iaculis vitae, vestibulum sed justo. Curabitur fringilla, mauris quis ultrices mattis, neque libero volutpat nisi, vel mollis mi magna a felis. Phasellus a orci ut elit sodales tristique ac placerat nisi. Maecenas orci purus, ullamcorper non neque vel, imperdiet sollicitudin ante. Duis dapibus ante sed gravida imperdiet. Aenean dapibus augue nec vehicula rhoncus. Mauris ac fermentum ante, eget volutpat lectus. Nunc a est auctor, suscipit augue vel, vulputate lectus. Sed eu elit ullamcorper, interdum neque ut, varius nisi. Phasellus leo justo, mattis rutrum leo vitae, consequat auctor diam. Vivamus cursus, ligula et euismod iaculis, odio nulla ullamcorper ex, vitae cursus mi lacus at sem. Aenean dictum odio dolor, sit amet gravida sem scelerisque vitae. Pellentesque habitant morbi tristique senectus et netus et malesuada fames ac turpis egestas. Morbi.


# Discussion

Lorem ipsum dolor sit amet, consectetur adipiscing elit. Vestibulum dignissim dignissim nunc, et finibus urna aliquam eget. Donec enim dolor, aliquam sed iaculis vitae, vestibulum sed justo. Curabitur fringilla, mauris quis ultrices mattis, neque libero volutpat nisi, vel mollis mi magna a felis. Phasellus a orci ut elit sodales tristique ac placerat nisi. Maecenas orci purus, ullamcorper non neque vel, imperdiet sollicitudin ante. Duis dapibus ante sed gravida imperdiet. Aenean dapibus augue nec vehicula rhoncus. Mauris ac fermentum ante, eget volutpat lectus. Nunc a est auctor, suscipit augue vel, vulputate lectus. Sed eu elit ullamcorper, interdum neque ut, varius nisi. Phasellus leo justo, mattis rutrum leo vitae, consequat auctor diam. Vivamus cursus, ligula et euismod iaculis, odio nulla ullamcorper ex, vitae cursus mi lacus at sem. Aenean dictum odio dolor, sit amet gravida sem scelerisque vitae. Pellentesque habitant morbi tristique senectus et netus et malesuada fames ac turpis egestas. Morbi.


# Acknowledgements

Lorem ipsum dolor sit amet, consectetur adipiscing elit. Vestibulum dignissim dignissim nunc, et finibus urna aliquam eget. Donec enim dolor, aliquam sed iaculis vitae, vestibulum sed justo. Curabitur fringilla, mauris quis ultrices mattis, neque libero volutpat nisi, vel mollis mi magna a felis. Phasellus a orci ut elit sodales tristique ac placerat nisi. Maecenas orci purus, ullamcorper non neque vel, imperdiet sollicitudin ante. 

